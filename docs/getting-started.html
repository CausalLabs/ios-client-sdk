<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Getting Started  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>
    <a title="Getting Started  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">CausalLabsSDK 0.6.0 Docs</a> (100% documented)</p>
        <p class="header-right"><a href="https://github.com/CausalLabs/ios-client-sdk"><img src="img/gh.png" alt="GitHub"/>View on GitHub</a></p>
        <div class="header-right">
          <form role="search" action="search.json">
            <input type="text" placeholder="Search documentation" data-typeahead>
          </form>
        </div>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">CausalLabsSDK Reference</a>
        <img id="carat" src="img/carat.png" alt=""/>
        Getting Started  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Guides.html">Guides</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="getting-started.html">Getting Started</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/CausalClient.html">CausalClient</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/CausalError.html">CausalError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/DebugLogVerbosity.html">DebugLogVerbosity</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Extensions/String.html">String</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/View.html">View</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/EventProtocol.html">EventProtocol</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/FeatureProtocol.html">FeatureProtocol</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/FeatureViewModel.html">FeatureViewModel</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/SessionProtocol.html">SessionProtocol</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Structs.html">Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Structs/FeatureRequest.html">FeatureRequest</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs.html#/s:13CausalLabsSDK12RequiredOnceV">RequiredOnce</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Typealiases.html">Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:13CausalLabsSDK8DeviceIda">DeviceId</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:13CausalLabsSDK9FeatureIda">FeatureId</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:13CausalLabsSDK12ImpressionIda">ImpressionId</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:13CausalLabsSDK10JSONObjecta">JSONObject</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:13CausalLabsSDK9SessionIda">SessionId</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <h1 id='getting-started' class='heading'>Getting Started</h1>

<p><em>This guide will help you get started using Causal.</em></p>

<blockquote>
<p><strong>Note</strong></p>

<p>This guide assumes you have completed the <a href="https://github.com/CausalLabs/ios-client-sdk/blob/main/README.md">installation and setup instructions</a>.</p>
</blockquote>
<h3 id='additional-resources' class='heading'>Additional Resources</h3>

<ul>
<li><a href="https://causallabs.github.io/ios-client-sdk">iOS SDK Documentation</a></li>
<li><a href="https://github.com/CausalLabs/ios-client-sdk/tree/main/Example">iOS Example App</a></li>
<li><a href="https://github.com/CausalLabs/ios-client-sdk/tree/main/Tests">iOS SDK Unit Tests</a></li>
<li><a href="https://tech.causallabs.io/docs/index">Causal Reference Documentation</a></li>
<li><a href="https://causallabs.io">Causal Labs</a></li>
</ul>
<h2 id='introduction' class='heading'>Introduction</h2>

<p>The SDK is written in a way that provides two layers: the core &ldquo;raw&rdquo; API, and a convenience API wrapper.</p>

<p>The core API is provided by <code><a href="Classes/CausalClient.html">CausalClient</a></code>. This allows you to request features and signal events directly.</p>

<p>The convenience API is generated from your FDL file. Some APIs, like signaling events, are available as methods you can call directly on your feature objects. We also generate a view model object for each feature that encapsulates all functionality for a single feature, reducing most of the boilerplate required for interacting with features and events. <code><a href="Classes/CausalClient.html">CausalClient</a></code> also provides some additional convenience methods.</p>
<h2 id='write-your-a-href-https-tech-causallabs-io-docs-fdl-example-fdl-fdl-file-a' class='heading'>Write your <a href="https://tech.causallabs.io/docs/fdl/example-fdl">FDL file</a></h2>

<p>The first step is defining your features and events. Here&rsquo;s a small example:</p>
<pre class="highlight plaintext"><code>feature RatingBox {
    args {
        "The product that we are collecting ratings for"
        product: String!
    }

    output {
        "The text next to the stars that prompts the visitor to rate the product"
        callToAction: String! = "Rate this product!"

        "The button text for the user submit a review."
        actionButton: String! = "Send Review"
    }

    "Occurs each time a rating is collected"
    event Rating {
        stars: Int!
    }
}
</code></pre>

<p>Build your Xcode project to generate and view the corresponding Swift code.</p>
<h2 id='configure-the-code-causalclient-code' class='heading'>Configure the <code><a href="Classes/CausalClient.html">CausalClient</a></code></h2>

<p>The <code><a href="Classes/CausalClient.html">CausalClient</a></code> is the main entry point into the SDK. Before you start writing code to use the features you defined in your FDL file, you need to configure the <code><a href="Classes/CausalClient.html">CausalClient</a></code>.</p>

<p>This setup should occur during app launch, <strong>before</strong> you attempt to use any part of the SDK, or your generated features and events.</p>
<pre class="highlight swift"><code><span class="c1">// Set the URL for your impression server</span>
<span class="kt">CausalClient</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">impressionServer</span> <span class="o">=</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="s">"https://tools.causallabs.io/sandbox-iserver"</span><span class="p">)</span><span class="o">!</span>

<span class="c1">// Construct and set your initial session</span>
<span class="kt">CausalClient</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="kt">Session</span><span class="p">(</span><span class="nv">deviceId</span><span class="p">:</span> <span class="kt">UUID</span><span class="p">()</span><span class="o">.</span><span class="n">uuidString</span><span class="p">)</span>
</code></pre>

<p>For SwiftUI apps, configuration should happen during initialization of your <code>App</code>:</p>
<pre class="highlight swift"><code><span class="kd">@main</span>
<span class="kd">struct</span> <span class="kt">MyApp</span><span class="p">:</span> <span class="kt">App</span> <span class="p">{</span>
    <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>
        <span class="kt">CausalClient</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">impressionServer</span> <span class="o">=</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="s">"https://tools.causallabs.io/sandbox-iserver"</span><span class="p">)</span><span class="o">!</span>
        <span class="kt">CausalClient</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="kt">Session</span><span class="p">(</span><span class="nv">deviceId</span><span class="p">:</span> <span class="kt">UUID</span><span class="p">()</span><span class="o">.</span><span class="n">uuidString</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="n">some</span> <span class="kt">Scene</span> <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>For UIKit apps, configuration should happen in your <code>AppDelegate</code>:</p>
<pre class="highlight swift"><code><span class="kd">@main</span>
<span class="kd">final</span> <span class="kd">class</span> <span class="kt">AppDelegate</span><span class="p">:</span> <span class="kt">UIResponder</span><span class="p">,</span> <span class="kt">UIApplicationDelegate</span> <span class="p">{</span>

    <span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="n">_</span> <span class="nv">application</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">,</span> <span class="n">didFinishLaunchingWithOptions</span> <span class="nv">launchOptions</span><span class="p">:</span> <span class="p">[</span><span class="kt">UIApplication</span><span class="o">.</span><span class="kt">LaunchOptionsKey</span><span class="p">:</span> <span class="kt">Any</span><span class="p">]?)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
        <span class="kt">CausalClient</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">impressionServer</span> <span class="o">=</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="s">"https://tools.causallabs.io/sandbox-iserver"</span><span class="p">)</span><span class="o">!</span>
        <span class="kt">CausalClient</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="kt">Session</span><span class="p">(</span><span class="nv">deviceId</span><span class="p">:</span> <span class="kt">UUID</span><span class="p">()</span><span class="o">.</span><span class="n">uuidString</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">true</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<blockquote>
<p><strong>Note</strong></p>

<p>If you need to debug issues with the SDK, you can enable verbose logging:</p>
<pre class="highlight swift"><code><span class="kt">CausalClient</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">debugLogging</span> <span class="o">=</span> <span class="o">.</span><span class="n">verbose</span>
</code></pre>
</blockquote>
<h2 id='requesting-features' class='heading'>Requesting Features</h2>

<p>Now you are ready to request features from the impression server.</p>

<p>You can use the core API to request a batch of updated features directly.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">features</span> <span class="o">=</span> <span class="p">[</span><span class="cm">/* array of features */</span><span class="p">]</span>

<span class="c1">// updates features in-place</span>
<span class="n">await</span> <span class="kt">CausalClient</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="nf">updateFeatures</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

<span class="c1">// you can optionally handle potential errors</span>
<span class="k">let</span> <span class="nv">error</span> <span class="o">=</span> <span class="n">await</span> <span class="kt">CausalClient</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="nf">updateFeatures</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
<span class="k">if</span> <span class="k">let</span> <span class="nv">error</span> <span class="p">{</span>
    <span class="c1">// check and handle error</span>
<span class="p">}</span>
</code></pre>

<p>If you prefer a more verbose API, use <code>requestFeatures()</code>.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">features</span> <span class="o">=</span> <span class="p">[</span><span class="cm">/* array of features */</span><span class="p">]</span>

<span class="k">do</span> <span class="p">{</span>
    <span class="k">try</span> <span class="n">await</span> <span class="kt">CausalClient</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="nf">requestFeatures</span><span class="p">(</span><span class="nv">features</span><span class="p">:</span> <span class="n">features</span><span class="p">)</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
    <span class="c1">// handle error</span>
<span class="p">}</span>
</code></pre>

<p>If desired, you can request a batch of features to be cached for later use. Do this when you want to avoid network requests and have features be available immediately later in your app lifecycle. If using <code>requestCacheFill()</code>, you should do so as early as possible in your app lifecycle.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">features</span> <span class="o">=</span> <span class="p">[</span><span class="cm">/* array of features */</span><span class="p">]</span>

<span class="k">try</span><span class="p">?</span> <span class="n">await</span> <span class="kt">CausalClient</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="nf">requestCacheFill</span><span class="p">(</span><span class="nv">features</span><span class="p">:</span> <span class="n">features</span><span class="p">)</span>
</code></pre>

<p>If you are only interacting with a single feature, we recommend using its corresponding <code>ViewModel</code> class instead of the core API. See below for details.</p>
<h2 id='using-features' class='heading'>Using Features</h2>

<p>You can now start building your UI that corresponds to your features. You can use your features directly, but we recommend using the generated view model because it encapsulates a lot of common boilerplate. A view model class will be generated for each feature you define. In SwiftUI or UIKit, you can construct the view model and use it to build your view and interact with the feature.</p>
<pre class="highlight swift"><code><span class="c1">// Create the view model</span>
<span class="k">let</span> <span class="nv">viewModel</span> <span class="o">=</span> <span class="kt">RatingBoxViewModel</span><span class="p">(</span><span class="nv">product</span><span class="p">:</span> <span class="s">"my product"</span><span class="p">)</span>

<span class="c1">// Request the feature</span>
<span class="k">try</span><span class="p">?</span> <span class="n">await</span> <span class="n">viewModel</span><span class="o">.</span><span class="nf">requestFeature</span><span class="p">()</span>

<span class="c1">// Do something with the feature</span>
<span class="k">let</span> <span class="nv">ratingBox</span> <span class="o">=</span> <span class="n">viewModel</span><span class="o">.</span><span class="n">feature</span>

<span class="c1">// Signal the feature's events</span>
<span class="n">viewModel</span><span class="o">.</span><span class="nf">signalRating</span><span class="p">(</span><span class="nv">stars</span><span class="p">:</span> <span class="mi">5</span><span class="p">)</span>
</code></pre>

<p>However, if you want to use features directly, you can:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">ratingBox</span> <span class="o">=</span> <span class="kt">RatingBox</span><span class="p">(</span><span class="nv">product</span><span class="p">:</span> <span class="s">"my product"</span><span class="p">)</span>

<span class="n">await</span> <span class="kt">CausalClient</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="nf">updateFeatures</span><span class="p">([</span><span class="n">ratingBox</span><span class="p">])</span>

<span class="c1">// do something with ratingBox</span>
</code></pre>
<h2 id='integration-with-swiftui' class='heading'>Integration with SwiftUI</h2>

<p>For SwiftUI, the best approach is to utilize the feature&rsquo;s view model (which is an <code>ObservableObject</code>) to drive your UI. We also provide a convenient view modifier for requesting a feature exactly once during the view lifecycle.</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">MyView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="c1">// Observe changes to viewModel via @StateObject</span>
    <span class="kd">@StateObject</span> <span class="k">var</span> <span class="nv">viewModel</span> <span class="o">=</span> <span class="kt">RatingBoxViewModel</span><span class="p">(</span><span class="nv">product</span><span class="p">:</span> <span class="s">"my product"</span><span class="p">)</span>

    <span class="kd">@State</span> <span class="k">var</span> <span class="nv">stars</span><span class="p">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1">// Create your view using the properties on viewModel.feature</span>
    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="n">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">VStack</span> <span class="p">{</span>
            <span class="kt">Text</span><span class="p">(</span><span class="n">viewModel</span><span class="o">.</span><span class="n">feature</span><span class="p">?</span><span class="o">.</span><span class="n">callToAction</span> <span class="p">??</span> <span class="s">""</span><span class="p">)</span>

            <span class="kt">StarsRatingView</span><span class="p">()</span>

            <span class="kt">Button</span> <span class="p">{</span>
                <span class="c1">// Signal events directly from the viewModel</span>
                <span class="n">viewModel</span><span class="o">.</span><span class="nf">signalRating</span><span class="p">(</span><span class="nv">stars</span><span class="p">:</span> <span class="n">stars</span><span class="p">)</span>
            <span class="p">}</span> <span class="nv">label</span><span class="p">:</span> <span class="p">{</span>
                <span class="kt">Text</span><span class="p">(</span><span class="n">viewModel</span><span class="o">.</span><span class="n">feature</span><span class="p">?</span><span class="o">.</span><span class="n">actionButton</span> <span class="p">??</span> <span class="s">""</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="c1">// Request the feature exactly once with the view modifier</span>
        <span class="o">.</span><span class="nf">requestFeature</span><span class="p">(</span><span class="n">viewModel</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h2 id='signaling-events' class='heading'>Signaling Events</h2>

<p>We recommend signaling events via your feature&rsquo;s view model:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">viewModel</span> <span class="o">=</span> <span class="kt">RatingBoxViewModel</span><span class="p">(</span><span class="nv">product</span><span class="p">:</span> <span class="s">"my product"</span><span class="p">)</span>

<span class="c1">// Signal the feature's "rating" event</span>
<span class="n">viewModel</span><span class="o">.</span><span class="nf">signalRating</span><span class="p">(</span><span class="nv">stars</span><span class="p">:</span> <span class="mi">5</span><span class="p">)</span>
</code></pre>

<p>However, you can also call the corresponding <code>signal*()</code> method directly on your feature, which is a &ldquo;fire-and-forget&rdquo; method:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">ratingBox</span> <span class="o">=</span> <span class="kt">RatingBox</span><span class="p">(</span><span class="nv">product</span><span class="p">:</span> <span class="s">"my product"</span><span class="p">)</span>

<span class="n">ratingBox</span><span class="o">.</span><span class="nf">signalRating</span><span class="p">(</span><span class="nv">stars</span><span class="p">:</span> <span class="mi">5</span><span class="p">)</span>
</code></pre>

<p>If you prefer to <code>await</code> the request and check for errors, you can use <code>signalAndWait()</code>:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">ratingBox</span> <span class="o">=</span> <span class="kt">RatingBox</span><span class="p">(</span><span class="nv">product</span><span class="p">:</span> <span class="s">"my product"</span><span class="p">)</span>

<span class="k">do</span> <span class="p">{</span>
    <span class="k">try</span> <span class="n">await</span> <span class="n">ratingBox</span><span class="o">.</span><span class="nf">signalAndWaitRating</span><span class="p">(</span><span class="nv">stars</span><span class="p">:</span> <span class="mi">5</span><span class="p">)</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
    <span class="c1">// handle error</span>
<span class="p">}</span>
</code></pre>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2023 <a class="link" href="https://www.causallabs.io" target="_blank" rel="external noopener">Causal Labs, Inc.</a>. All rights reserved. (Last updated: 2023-07-17)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external noopener">jazzy ♪♫ v0.14.3</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external noopener">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</html>
